<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Submit a DoES Issue</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<form id="issueForm" class="issue-form">
<div class="form-group">
  <label for="title">Issue Title *</label>
  <input type="text" id="title" name="title" required placeholder="e.g. Gerald is sad again">
</div>

<div class="form-group">
  <label for="description">Description *</label>
  <textarea id="description" name="description" required rows="8" placeholder="Describe the issue as if whispering it to Geraldâ€¦"></textarea>
</div>


  <fieldset>
    <legend>ğŸ›  Tools Involved</legend>
    <select name="tool[]" id="tool" multiple title="Select one or more tools that relate to the issue.">
      <option>Laser Cutter - Large (Gerald)</option>
      <option>Laser Cutter (Sheila)</option>
      <option>Laser Cutter - Monster (Tony)</option>
      <option>Vinyl Cutter & Plotter (Roland Rat)</option>
      <option>Pen Plotter - McGraw</option>
      <option>B/W Laser Printer</option>
      <option>Heat Press (St. Margaret)</option>
      <option>3D Printer - CR-6 MAX (Marcus)</option>
      <option>Singer 201K Sewing m/c (Miss Polly)</option>
    </select>
  </fieldset>

  <fieldset>
    <legend>ğŸ¢ Rooms Affected</legend>
    <select name="room[]" id="room" multiple title="Which physical spaces are involved or impacted?">
      <option>Events Room</option>
      <option>Laser Room</option>
      <option>Textiles Room</option>
      <option>Main Space</option>
      <option>Kitchen</option>
      <option>Workshop</option>
      <option>Other / Not Listed</option>
    </select>
  </fieldset>

  <fieldset>
    <legend>ğŸ’» Systems Involved</legend>
    <select name="system[]" id="system" multiple title="Digital systems or infrastructure related to the issue.">
      <option>Website</option>
      <option>DoES Community Online System: Issue Tracker</option>
    </select>
  </fieldset>

  <fieldset>
    <legend>ğŸ“¦ Other Categories</legend>
    <select name="other[]" id="other" multiple title="General themes or concerns that apply.">
      <option>Health & Safety</option>
      <option>Finance</option>
      <option>Promotion</option>
      <option>Spreading the word about how epic DoES Liverpool is</option>
    </select>
  </fieldset>

  <label for="name">Your Name (optional)</label>
  <input type="text" id="name" name="name" placeholder="e.g. Ed, or leave blank">
<p class="form-disclaimer">âš ï¸ This form doesnâ€™t submit anything yet. Itâ€™s like Gerald before coffeeâ€”beautiful, but not quite functional. (Note Gerald doesn't actually need coffee - he's a laser cutter - he just needs cleaning out when you've finished)</p>

  <button type="submit" class="submit-button">Submit Issue</button>
</form>
  <script>
    document.getElementById('issueForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const title = document.getElementById('title').value.trim();
  const description = document.getElementById('description').value.trim();
  const name = document.getElementById('name').value.trim();
  const tools = Array.from(document.getElementById('tool').selectedOptions).map(opt => opt.value);
  const rooms = Array.from(document.getElementById('room').selectedOptions).map(opt => opt.value);
  const systems = Array.from(document.getElementById('system').selectedOptions).map(opt => opt.value);
  const categories = Array.from(document.getElementById('other').selectedOptions).map(opt => opt.value);

  const payload = {
    title,
    description,
    name,
    tools,
    rooms,
    systems,
    categories
  };

  try {
    const response = await fetch('http://localhost:3000/submit-issue', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    const result = await response.json();

    if (response.ok) {
      alert(`âœ… Issue submitted!\n\nView it here: ${result.issueUrl}`);
    } else {
      alert(`âŒ Submission failed: ${result.message || 'Unknown error'}`);
    }
  } catch (error) {
    console.error('Submission error:', error);
    alert('âŒ Failed to submit issue. Check your server and network connection.');
  }
});

  </script>
</body>
</html>


</body>
</html>
